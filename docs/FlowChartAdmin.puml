@startuml
skinparam monochrome true
skinparam shadowing false
left to right direction
title Fog Order System Flow

start
:frontPage.html;

:Formular 1 - Kundeoplysninger;
:POST /formular1;
:CustomerController.handleFormular1();

:Formular 2 - Materialevalg og SVG;
:POST /formular2;
:CustomerController.handleFormular2();
:OrderMapper.insertOrder();
:MaterialVariantMapper.insertVariant();
:BillOfMaterialsMapper.insertBom();

:Ordre gemt i systemet;
stop

== Admin-login flow ==
@startuml
start
:Admin-login.html;
:Admin indtaster email + kodeord;
:POST /admin-login;
:LoginController.handleLogin();
:UserMapper.findByEmailAndPassword();

if (Login success?) then (yes)
  :Redirect to /admin;
  :AdminController.showAllOrders();
  :OrderMapper.getAllOrders();

  :Admin v√¶lger specifik ordre;
  :AdminController.showOrderDetails();
  :OrderMapper.getOrderById();
  :MaterialVariantMapper.getByOrderId();

  :Admin skriver tilbud;
  :POST /admin/ordre/:id/sendtilbud;
  :AdminController.handleSendTilbud();
  :OrderMapper.updateSalesInfo();
  :SugMapper.insertSug();
  :EmailService.sendEmail();
  :Tilbud sendt til kunde via e-mail;
else (no)
  :Vis login fejl;
endif

stop
@enduml
