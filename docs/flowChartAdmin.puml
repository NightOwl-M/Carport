@startuml
skinparam monochrome true
skinparam shadowing false
left to right direction
title Carport Admin Flow (opdelt i grene fra dashboard)
@startuml

start

:Admin åbner /adminlogin;
:GET /adminlogin;
:Render adminlogin.html;

:Indtaster brugernavn og kode;
:POST /admin/login;
:AdminLoginService.handleAdminLogin();
:AdminLoginMapper.checkAdminLoginCredentials();
if (Gyldig login?) then (ja)
  :Set isAdmin session attribut;
  :Redirect til /admindashboard;
  :Render admindashboard.html;

  split
    :Klik på 'Unprocessed';
    :GET /admin/orders/unprocessed;
    :OrderService.getOrderSummariesByStatus(1);
    :Render unprocessed.html;

    :Klik på en ordre;
    :GET /admin/orders/unprocessed/{orderId};
    :OrderService.getUnprocessedOrderById();
    :Render unprocessedorder.html;

    :Klik på 'Giv tilbud';
    :GET /offerpage;
    :Render offerpage.html;

    :Indtast info og tryk 'Videre';
    :POST /offerpage/generate-offer;
    :Beregn pris;
    :Render offerpageconfirmation.html;

    :Klik på 'Se stykliste';
    :GET /offerpage/show-bom;
    :Render bompage.html;

    :Klik på 'Send tilbud';
    :POST /offerpage/send-offer;
    :Opdater ordre og send email;
    :Ryd sessiondata;
    :Render admindashboard.html;
  split again
    :Klik på 'Pending';
    :GET /admin/orders/pending;
    :OrderService.getOrderSummariesByStatus(2);
    :Render pending.html;

    :Klik evt. på ordre for detaljer;
    :GET /admin/orders/pending/{orderId};
    :Render pendingorder.html;
  split again
    :Klik på 'Processed';
    :GET /admin/orders/processed;
    :OrderService.getOrderSummariesByStatus(3);
    :Render processed.html;

    :Klik evt. på ordre for detaljer;
    :GET /admin/orders/processed/{orderId};
    :Render processedorder.html;
  end split

else (nej)
  :Redirect til adminlogin.html;
  :Vis fejlmeddelelse;
endif

stop
@enduml
