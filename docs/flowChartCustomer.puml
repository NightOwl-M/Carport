@startuml
skinparam monochrome true
skinparam shadowing false
left to right direction
title Kunde-flow – Carport Bestilling (OrderController)
@startuml

start

:Startside /carport;
:GET /carport;
:Render form1.html;

:Bruger indtaster bredde, længde, tagtype, kommentar;
:Submitter form1;
:POST /carport/info;
:OrderController.handleCarportInfo();
:Set session width, length, roof, customerText;
:Redirect til /carport/info;

:Form2 - Personoplysninger;
:GET /carport/info;
:Render form2.html;

:Bruger indtaster navn, adresse, postnr, mail, tlf;
:Submitter form2;
:POST /carport/confirm;
:OrderController.handleConfirmation();
:Validerer felter og sætter dem i session;
:Redirect til /carport/confirm;

:Form3 - Bekræft side;
:GET /carport/confirm;
:OrderController.showConfirmationPage();
:Validerer at alle session-attributter findes;
:Opretter midlertidig Order og Customer;
:Genererer SVG igen;
:Render form3.html med attributter;

:Bruger bekræfter og trykker "Godkend";
:POST /carport/confirm/save;
:OrderController.saveOrderToDatabase();
:Kalder OrderService.createOrderAndCustomer(...);
:Indsætter kunde og ordre i database;
:Rydder session;
:Redirect til /thankyoupage;

:Tak for din bestilling;
:GET /thankyoupage;
:Render thankyoupage.html;

stop
@enduml
